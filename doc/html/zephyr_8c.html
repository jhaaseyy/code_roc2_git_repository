<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>code_roc2: roc2.3_code_2018-06-09/root/roc/roc/zephyr.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">code_roc2
   </div>
   <div id="projectbrief">ROC2 radio occultation code records data files and transfers to zephyr payload management system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_88430af1563971ec5590fc314f3d4986.html">roc2.3_code_2018-06-09</a></li><li class="navelem"><a class="el" href="dir_1024a9f9cc14602e36a30facb2c4cd46.html">root</a></li><li class="navelem"><a class="el" href="dir_effe0a4def3cdf89472b022541cb4a5c.html">roc</a></li><li class="navelem"><a class="el" href="dir_fdaf8ae40eaef4118e61baedd4373f73.html">roc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">zephyr.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>ROC2 Zephyr Interface Module.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;libconfig.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;termios.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;sys/ioctl.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;poll.h&gt;</code><br />
<code>#include &lt;signal.h&gt;</code><br />
<code>#include &lt;dirent.h&gt;</code><br />
<code>#include &quot;<a class="el" href="zephyr_8h_source.html">zephyr.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a777ab160b5ad985f2ccc1a878e5936fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zephyr_8c.html#a777ab160b5ad985f2ccc1a878e5936fd">SEPTENTRIOTOGLNG</a>&#160;&#160;&#160;300000</td></tr>
<tr class="memdesc:a777ab160b5ad985f2ccc1a878e5936fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function.  <a href="#a777ab160b5ad985f2ccc1a878e5936fd">More...</a><br /></td></tr>
<tr class="separator:a777ab160b5ad985f2ccc1a878e5936fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top"><a id="a0ddf1224851353fc92bfbff6f499fa97"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4420395a38828d6be4aae8646268d258"><td class="memItemLeft" align="right" valign="top"><a id="a4420395a38828d6be4aae8646268d258"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>MsgHandler</b> (enum <a class="el" href="zephyr_8h.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> msgtype, char *msgdata)</td></tr>
<tr class="separator:a4420395a38828d6be4aae8646268d258"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8252c63f3bdc239fbdf6fbd93d40c76"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zephyr_8c.html#ac8252c63f3bdc239fbdf6fbd93d40c76">HandleIM</a> (char *msgdata)</td></tr>
<tr class="separator:ac8252c63f3bdc239fbdf6fbd93d40c76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5b4e6f9b660a68301b5cd686040e61a"><td class="memItemLeft" align="right" valign="top"><a id="ac5b4e6f9b660a68301b5cd686040e61a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>HandleSAck</b> (char *msgdata)</td></tr>
<tr class="separator:ac5b4e6f9b660a68301b5cd686040e61a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81340cc09bb1fbb59c968fa3d3b41064"><td class="memItemLeft" align="right" valign="top"><a id="a81340cc09bb1fbb59c968fa3d3b41064"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>HandleSW</b> (char *msgdata)</td></tr>
<tr class="separator:a81340cc09bb1fbb59c968fa3d3b41064"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a405decabf57ea3d65a9fea453e4a2fa3"><td class="memItemLeft" align="right" valign="top"><a id="a405decabf57ea3d65a9fea453e4a2fa3"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>HandleTMAck</b> (char *msgdata)</td></tr>
<tr class="separator:a405decabf57ea3d65a9fea453e4a2fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24fd4d56749147dbdfbb5817276010a8"><td class="memItemLeft" align="right" valign="top"><a id="a24fd4d56749147dbdfbb5817276010a8"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>HandleTC</b> (char *msgdata)</td></tr>
<tr class="separator:a24fd4d56749147dbdfbb5817276010a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f9ac83f838130b9d2723d02ae37562e"><td class="memItemLeft" align="right" valign="top"><a id="a6f9ac83f838130b9d2723d02ae37562e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>HandleGPS</b> (char *msgdata)</td></tr>
<tr class="separator:a6f9ac83f838130b9d2723d02ae37562e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26a5cd9326852a6f3a89225c8642479b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zephyr_8c.html#a26a5cd9326852a6f3a89225c8642479b">ZephyrInit</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a26a5cd9326852a6f3a89225c8642479b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs module initialization.  <a href="#a26a5cd9326852a6f3a89225c8642479b">More...</a><br /></td></tr>
<tr class="separator:a26a5cd9326852a6f3a89225c8642479b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40809263d9e34d3d93cdb0eed73db857"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zephyr_8c.html#a40809263d9e34d3d93cdb0eed73db857">ZephyrCleanup</a> (void)</td></tr>
<tr class="memdesc:a40809263d9e34d3d93cdb0eed73db857"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes sockets and frees memory.  <a href="#a40809263d9e34d3d93cdb0eed73db857">More...</a><br /></td></tr>
<tr class="separator:a40809263d9e34d3d93cdb0eed73db857"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dbf303fd2c465b1e724a247623fdbd2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zephyr_8c.html#a5dbf303fd2c465b1e724a247623fdbd2">CmdLineHandler</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a5dbf303fd2c465b1e724a247623fdbd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses command line arguments.  <a href="#a5dbf303fd2c465b1e724a247623fdbd2">More...</a><br /></td></tr>
<tr class="separator:a5dbf303fd2c465b1e724a247623fdbd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40185ea52d16cecaafae70740e90af29"><td class="memItemLeft" align="right" valign="top"><a id="a40185ea52d16cecaafae70740e90af29"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zephyr_8c.html#a40185ea52d16cecaafae70740e90af29">Usage</a> (void)</td></tr>
<tr class="memdesc:a40185ea52d16cecaafae70740e90af29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the usage summary showing valid command line options. <br /></td></tr>
<tr class="separator:a40185ea52d16cecaafae70740e90af29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ed0e63e6cf78544f92b023037e3e7b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zephyr_8c.html#a8ed0e63e6cf78544f92b023037e3e7b8">LoadConfigFileSettings</a> (config_t *cfg, const char *path)</td></tr>
<tr class="memdesc:a8ed0e63e6cf78544f92b023037e3e7b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the program configuration file.  <a href="#a8ed0e63e6cf78544f92b023037e3e7b8">More...</a><br /></td></tr>
<tr class="separator:a8ed0e63e6cf78544f92b023037e3e7b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919ac26442368faff61c89f0f62fd58b"><td class="memItemLeft" align="right" valign="top"><a id="a919ac26442368faff61c89f0f62fd58b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>SerialPortInit</b> (<a class="el" href="structserial.html">serial</a> port)</td></tr>
<tr class="separator:a919ac26442368faff61c89f0f62fd58b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af890f66e1e86cf2e43aafd221eddabbd"><td class="memItemLeft" align="right" valign="top"><a id="af890f66e1e86cf2e43aafd221eddabbd"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_baud</b> (int baud)</td></tr>
<tr class="separator:af890f66e1e86cf2e43aafd221eddabbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adab6d320323ece6f7627cb9bb04d0eb9"><td class="memItemLeft" align="right" valign="top"><a id="adab6d320323ece6f7627cb9bb04d0eb9"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>verify_bits</b> (const char *bits)</td></tr>
<tr class="separator:adab6d320323ece6f7627cb9bb04d0eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10d59c21de300f9eae88f1b90ef845f2"><td class="memItemLeft" align="right" valign="top"><a id="a10d59c21de300f9eae88f1b90ef845f2"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>verify_flow</b> (const char *bits)</td></tr>
<tr class="separator:a10d59c21de300f9eae88f1b90ef845f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bacb9e2137b9572d5f02c23de2ad813"><td class="memItemLeft" align="right" valign="top"><a id="a0bacb9e2137b9572d5f02c23de2ad813"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><b>TodaysDirectoryName</b> (void)</td></tr>
<tr class="separator:a0bacb9e2137b9572d5f02c23de2ad813"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29819f4927e98849304e948f13c12574"><td class="memItemLeft" align="right" valign="top"><a id="a29819f4927e98849304e948f13c12574"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><b>TodaysDirectoryPath</b> (void)</td></tr>
<tr class="separator:a29819f4927e98849304e948f13c12574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88fb6383c5c934e876be013729f8ab60"><td class="memItemLeft" align="right" valign="top"><a id="a88fb6383c5c934e876be013729f8ab60"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>TodaysDirectoryExists</b> (void)</td></tr>
<tr class="separator:a88fb6383c5c934e876be013729f8ab60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eaf55c523b081609cd85dd6eb04682b"><td class="memItemLeft" align="right" valign="top"><a id="a0eaf55c523b081609cd85dd6eb04682b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>CreateDayDirectory</b> (void)</td></tr>
<tr class="separator:a0eaf55c523b081609cd85dd6eb04682b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45786db9b46a6cc20e64bd0a851655bc"><td class="memItemLeft" align="right" valign="top"><a id="a45786db9b46a6cc20e64bd0a851655bc"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><b>LogFileName</b> (char *name)</td></tr>
<tr class="separator:a45786db9b46a6cc20e64bd0a851655bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b73dc85a9b8da6978eac659ec8531b"><td class="memItemLeft" align="right" valign="top"><a id="af8b73dc85a9b8da6978eac659ec8531b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>OpenLogFile</b> (char *name)</td></tr>
<tr class="separator:af8b73dc85a9b8da6978eac659ec8531b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84b0f0a6d9c4b56b743eb5b171f3172c"><td class="memItemLeft" align="right" valign="top"><a id="a84b0f0a6d9c4b56b743eb5b171f3172c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>CloseLogFile</b> (void)</td></tr>
<tr class="separator:a84b0f0a6d9c4b56b743eb5b171f3172c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5366f78d45883b7ad5934d6910efa6c5"><td class="memItemLeft" align="right" valign="top"><a id="a5366f78d45883b7ad5934d6910efa6c5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>NewFile</b> (void)</td></tr>
<tr class="separator:a5366f78d45883b7ad5934d6910efa6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31e21e2ff935496c7ce8dc5e52b65c3"><td class="memItemLeft" align="right" valign="top"><a id="af31e21e2ff935496c7ce8dc5e52b65c3"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>LogData</b> (FILE *<a class="el" href="zephyr_8h.html#aa065f30aa9f5f9a42132c82c787ee70b">fp</a>, char *data, int n)</td></tr>
<tr class="separator:af31e21e2ff935496c7ce8dc5e52b65c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab66e64dd30463cea0a06ac33c9cb3522"><td class="memItemLeft" align="right" valign="top"><a id="ab66e64dd30463cea0a06ac33c9cb3522"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><b>GetNextFile</b> (void)</td></tr>
<tr class="separator:ab66e64dd30463cea0a06ac33c9cb3522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184ae444081beacfe0bd5b712d378b59"><td class="memItemLeft" align="right" valign="top"><a id="a184ae444081beacfe0bd5b712d378b59"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>SendFile</b> (char *name)</td></tr>
<tr class="separator:a184ae444081beacfe0bd5b712d378b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af672e15ff453fe857ab4ce7de925f34a"><td class="memItemLeft" align="right" valign="top"><a id="af672e15ff453fe857ab4ce7de925f34a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>TCSendFile</b> (char *name)</td></tr>
<tr class="separator:af672e15ff453fe857ab4ce7de925f34a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf9cb423a606dc4f8232d1b3394042d5"><td class="memItemLeft" align="right" valign="top"><a id="abf9cb423a606dc4f8232d1b3394042d5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>RemoveFile</b> (char *name)</td></tr>
<tr class="separator:abf9cb423a606dc4f8232d1b3394042d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e021f179fc712de402af1043ca1a9ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zephyr_8c.html#a6e021f179fc712de402af1043ca1a9ef">SendMsg</a> (enum <a class="el" href="zephyr_8h.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> msgtype, char *payload, int payload_size)</td></tr>
<tr class="separator:a6e021f179fc712de402af1043ca1a9ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabe674fb7d630daaebb86607af12308a"><td class="memItemLeft" align="right" valign="top"><a id="aabe674fb7d630daaebb86607af12308a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>CRCComp</b> (char *data, int len)</td></tr>
<tr class="separator:aabe674fb7d630daaebb86607af12308a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a626fb8bdfcd2bed45be4fe9fabb74f48"><td class="memItemLeft" align="right" valign="top"><a id="a626fb8bdfcd2bed45be4fe9fabb74f48"></a>
unsigned short&#160;</td><td class="memItemRight" valign="bottom"><b>CRC</b> (unsigned short last, char next)</td></tr>
<tr class="separator:a626fb8bdfcd2bed45be4fe9fabb74f48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7865b0822633a51bd794f1922f39711"><td class="memItemLeft" align="right" valign="top"><a id="aa7865b0822633a51bd794f1922f39711"></a>
unsigned short&#160;</td><td class="memItemRight" valign="bottom"><b>ComputeCRC</b> (char *data, int len)</td></tr>
<tr class="separator:aa7865b0822633a51bd794f1922f39711"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a224d36d32fdd9a46fced3ac36c639169"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="zephyr_8h.html#a10a0f35066079abd150539d0d13dbf3e">msg</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zephyr_8c.html#a224d36d32fdd9a46fced3ac36c639169">MsgType</a> (char *typestr)</td></tr>
<tr class="separator:a224d36d32fdd9a46fced3ac36c639169"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a093f472d65a4478a2a23fa69ea593ef0"><td class="memItemLeft" align="right" valign="top"><a id="a093f472d65a4478a2a23fa69ea593ef0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>gps_power</b> (int state)</td></tr>
<tr class="separator:a093f472d65a4478a2a23fa69ea593ef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1aef5309c25647017f7108bc58873f7"><td class="memItemLeft" align="right" valign="top"><a id="af1aef5309c25647017f7108bc58873f7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>gps_reset</b> (int state)</td></tr>
<tr class="separator:af1aef5309c25647017f7108bc58873f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450d4faa9f19206a09ccd2e461eff601"><td class="memItemLeft" align="right" valign="top"><a id="a450d4faa9f19206a09ccd2e461eff601"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>gps_power_toggle</b> (int state)</td></tr>
<tr class="separator:a450d4faa9f19206a09ccd2e461eff601"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e696bce041fca9cc1924bcd65cbc503"><td class="memItemLeft" align="right" valign="top"><a id="a7e696bce041fca9cc1924bcd65cbc503"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_safe</b> (int state)</td></tr>
<tr class="separator:a7e696bce041fca9cc1924bcd65cbc503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94bb341ea8ea68eb26f43e8664513609"><td class="memItemLeft" align="right" valign="top"><a id="a94bb341ea8ea68eb26f43e8664513609"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>led</b> (int state)</td></tr>
<tr class="separator:a94bb341ea8ea68eb26f43e8664513609"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac266e79779ea42b506b577821d4a834d"><td class="memItemLeft" align="right" valign="top"><a id="ac266e79779ea42b506b577821d4a834d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_gpio0</b> (int state)</td></tr>
<tr class="separator:ac266e79779ea42b506b577821d4a834d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ROC2 Zephyr Interface Module. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>2018 David Jabson, Brainstorm Engineering</dd></dl>
<p>This program is the first version of data collection software for the ROC2 Radio Occultation Instrument. It lacks the full feature set of the final instrument but performs the following:</p>
<ul>
<li>Reads configuration file to determine commands for setting up GPS receiver</li>
<li>Configures GPS receiver</li>
<li>Launch data offload program</li>
<li>Logs data received from GPS receiver to files</li>
<li>When data file is closed, calls data processing script and open new file </li>
</ul>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a777ab160b5ad985f2ccc1a878e5936fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a777ab160b5ad985f2ccc1a878e5936fd">&#9670;&nbsp;</a></span>SEPTENTRIOTOGLNG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEPTENTRIOTOGLNG&#160;&#160;&#160;300000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main function. </p>
<p>Calls <a class="el" href="zephyr_8c.html#a26a5cd9326852a6f3a89225c8642479b" title="Performs module initialization. ">ZephyrInit()</a> to perform initialization then enters the main while loop where it .... the main loop stops, then <a class="el" href="zephyr_8c.html#a40809263d9e34d3d93cdb0eed73db857" title="Closes sockets and frees memory. ">ZephyrCleanup()</a> is called before exiting. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a5dbf303fd2c465b1e724a247623fdbd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dbf303fd2c465b1e724a247623fdbd2">&#9670;&nbsp;</a></span>CmdLineHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CmdLineHandler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses command line arguments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>Number of command line arguments passed to main(). </td></tr>
    <tr><td class="paramname">argv[]</td><td>List of command line arguments passed to main(). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>BCSUCCESS if successful</li>
<li>BCERROR if there was an error parsing any of the command line options </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ac8252c63f3bdc239fbdf6fbd93d40c76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8252c63f3bdc239fbdf6fbd93d40c76">&#9670;&nbsp;</a></span>HandleIM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int HandleIM </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>msgdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>&lt; Switch to flight mode</p>
<p>&lt; Switch to Standby mode</p>
<p>&lt; Switch to Low Power mode</p>
<p>&lt; Switch to Safety mode</p>
<p>&lt; Switch to End Flight mode </p>

</div>
</div>
<a id="a8ed0e63e6cf78544f92b023037e3e7b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ed0e63e6cf78544f92b023037e3e7b8">&#9670;&nbsp;</a></span>LoadConfigFileSettings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int LoadConfigFileSettings </td>
          <td>(</td>
          <td class="paramtype">config_t *&#160;</td>
          <td class="paramname"><em>cfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the program configuration file. </p>
<p>This function opens the module's configuration file (whose path is defined in the pathCfgRoc global) and reads the contents. The currently supported settings that can be placed in the config file are:</p><ul>
<li>(Optional) Port number to use for incoming socket connections (socket_in)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cfg</td><td>Pointer to config_t object for storing state of config file operations. </td></tr>
    <tr><td class="paramname">path</td><td>String containing full path of the config file to read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>BCSUCCESS if successful</li>
<li>BCCONFIGREADERROR indicates an error reading the configuration file </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a224d36d32fdd9a46fced3ac36c639169"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a224d36d32fdd9a46fced3ac36c639169">&#9670;&nbsp;</a></span>MsgType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="zephyr_8h.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> MsgType </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>typestr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>&lt; Got an IM message</p>
<p>&lt; Got an SAck message</p>
<p>&lt; Got an SW message</p>
<p>&lt; Got a TMAck message</p>
<p>&lt; Got a TC message</p>
<p>&lt; Got a GPS message </p>

</div>
</div>
<a id="a6e021f179fc712de402af1043ca1a9ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e021f179fc712de402af1043ca1a9ef">&#9670;&nbsp;</a></span>SendMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SendMsg </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="zephyr_8h.html#a10a0f35066079abd150539d0d13dbf3e">msg</a>&#160;</td>
          <td class="paramname"><em>msgtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>payload_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>&lt; Tells Zephyr we're done booting and ready for mode change</p>
<p>&lt; Tells Zephyr we got the mode change command</p>
<p>&lt; always sending ACK for now, change later</p>
<p>&lt; Tells Zephyr we're in Safety mode now, ok to shut off power</p>
<p>&lt; Telemetry message. This is how we send data to Zephyr</p>
<p>&lt; Tells Zephyr we got the telecommand message (uplink data)</p>
<p>&lt; always sending ACK for now, change later </p>

</div>
</div>
<a id="a40809263d9e34d3d93cdb0eed73db857"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40809263d9e34d3d93cdb0eed73db857">&#9670;&nbsp;</a></span>ZephyrCleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZephyrCleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes sockets and frees memory. </p>
<p>There will be some serial port clean up stuff in here.</p>
<dl class="section return"><dt>Returns</dt><dd>Always returns BCSUCCESS </dd></dl>

</div>
</div>
<a id="a26a5cd9326852a6f3a89225c8642479b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26a5cd9326852a6f3a89225c8642479b">&#9670;&nbsp;</a></span>ZephyrInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZephyrInit </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs module initialization. </p>
<p>Calls <a class="el" href="zephyr_8c.html#a8ed0e63e6cf78544f92b023037e3e7b8" title="Reads the program configuration file. ">LoadConfigFileSettings()</a> to load the configuration file settings for this module and calls <a class="el" href="zephyr_8c.html#a5dbf303fd2c465b1e724a247623fdbd2" title="Parses command line arguments. ">CmdLineHandler()</a> to handle any command line options. Finally configures a ZMQ REP socket to listen for messages from other modules.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>Number of command line arguments passed to main(). </td></tr>
    <tr><td class="paramname">argv[]</td><td>List of command line arguments passed to main(). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>BCSUCCESS if successful.</li>
<li>BCCONFIGREADERROR indicates an error in <a class="el" href="zephyr_8c.html#a8ed0e63e6cf78544f92b023037e3e7b8" title="Reads the program configuration file. ">LoadConfigFileSettings()</a>.</li>
<li>BCCMDLINEERROR indicates an error in <a class="el" href="zephyr_8c.html#a5dbf303fd2c465b1e724a247623fdbd2" title="Parses command line arguments. ">CmdLineHandler()</a>.</li>
<li>BCZMQOPTERROR indicates an error setting the options of a ZMQ socket.</li>
<li>BCMODLISTERROR indicates an error in PopulateModules().</li>
<li>BCZMQBINDERROR indicates an error binding the ZMQ REP socket. </li>
</ul>
</dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
